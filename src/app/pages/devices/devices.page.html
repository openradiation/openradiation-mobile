<ion-content padding>
    <ion-button href="/tabs/(settings:settings)">
        Paramètres
    </ion-button>
    <ng-container *ngIf="isScanning$ | async; else isNotScanning">
        <ion-button (click)="stopDiscoverDevices()">Stop discover devices</ion-button>
    </ng-container>
    <ng-template #isNotScanning>
        <ion-button (click)="startDiscoverDevices()">Start discover devices</ion-button>
    </ng-template>
    <ion-list *ngIf="connectedDevice$ | async as connectedDevice">
        <ion-list-header>
            <ion-label>Capteur connecté</ion-label>
        </ion-list-header>
        <ion-item>
            <ion-label>
                {{connectedDevice.apparatusVersion}}<br>{{connectedDevice.apparatusId}}
            </ion-label>
            <ion-button *ngIf="connectedDevice.params && connectedDevice.paramsModel" (click)="editDeviceParams(connectedDevice)">
                <ion-icon slot="icon-only" name="settings"></ion-icon>
            </ion-button>
            <ion-button (click)="disconnectDevice()">
                Se déconnecter
            </ion-button>
        </ion-item>
    </ion-list>
    <ion-list *ngIf="isScanning$ | async">
        <ion-list-header>
            <ion-label>Capteurs disponibles</ion-label>
        </ion-list-header>
        <ion-item *ngFor="let availableDevice of availableDevices$ | async">
            <ion-label>
                {{availableDevice.apparatusVersion}}<br>{{availableDevice.apparatusId}}
            </ion-label>
            <ion-button (click)="connectDevice(availableDevice)">
                Se connecter
            </ion-button>
        </ion-item>
    </ion-list>
    <ion-list>
        <ion-list-header>
            <ion-label>Capteurs connus</ion-label>
        </ion-list-header>
        <ion-item *ngFor="let knownDevice of knownDevices$ | async">
            <ion-label>
                {{knownDevice.apparatusVersion}}<br>{{knownDevice.apparatusId}}
            </ion-label>
            <ion-button *ngIf="knownDevice.params && knownDevice.paramsModel" (click)="editDeviceParams(knownDevice)">
                <ion-icon slot="icon-only" name="settings"></ion-icon>
            </ion-button>
        </ion-item>
    </ion-list>
</ion-content>
